---
layout: post
title:  部署时代进化之Kubernetes
tagline: by IT可乐
categories: MybatisPlus
tags: 
    - IT可乐
---

哈喽，大家好，我是指北君。  
### 前言

之前指北君给大家介绍过 Docker的教程，接下来我们撬开 Kubernetes 的大门。

<img src="http://img.doutula.com/production/uploads/image/2019/07/09/20190709665166_JyqSkI.jpg" alt="给我冲！" style="zoom:33%;" />

### 1、官网镇楼

> https://kubernetes.io/

![img](/Users/yushuai/Documents/学习笔记/Kubernetes/image/image-00-00.png)

### 2、什么是 Kubernetes?

官方介绍：

> Kubernetes 是一个可移植的、可扩展的开源平台， Google 在 2014 年将其开源，它用于管理容器化的工作负载和服务，可促进声明式配置和自动化。
>
> Kubernetes 拥有一个庞大且快速增长的生态系统。Kubernetes 的服务、支持和工具广泛可用。

通俗来说，Kubernetes 是一个容器编排工具。

当业务规模足够大时，我们会有很多容器来跑各种服务，这么多服务如何批量管理？

之前学 Docker 时我们介绍过Docker的官方工具 Docker-compose ，但是这是一种单机容器管理工具，并不支持集群，虽然官方出了另一种集群管理工具 Docker Swarm，但是当你用上 Kubernetes 之后，你会觉得他们都是弟弟。

#### 2.1彩蛋

> **Kubernetes** 这个名字源于希腊语，意为“舵手”或“飞行员”。k8s 这个缩写是因为 k 和 s 之间有八个字符的关系。



### 3、部署时代演进

![image-20211117225948120](/Users/yushuai/Documents/学习笔记/Kubernetes/image/image-00-01.png)

#### 3.1 传统部署时代

部署一个服务，会粗略估计服务所需要的机器性能，然后去采购对应的真实物理机器，然后在该机器上安装服务需要的一些软件，比如服务器Tomcat，数据库MySQL等等。

> 1、部署非常慢：采购机器，安装系统，安装软件等等；
>
> 2、成本高以及资源浪费：通常为了以防服务性能不够，我们都会尽量采购比预期资源高一点的机器，不仅会增加成本，还会造成机器资源浪费；
>
> 3、难于扩展与迁移：由于是真实的物理机，扩展或者迁移会比较麻烦；



#### 3.2 虚拟机部署时代

VMware 相信大家都玩过，通过VMware 我们能在自己电脑上创建很多虚拟机器，而物理机时代就是在一台真实物理机上，虚拟出多台机器，而且每台机器都可以看做是一台独立的电脑。

相对于物理机时代，虚拟机能够在一台机器上创建多台机器，能够充分利用资源，并且也做到了机器之间的隔离，机器性能不够用了，也可以通过 Hypervisor 随时进行扩展。

虚拟化技术相对于传统部署时代能够更好地利用物理服务器上的资源，并且因为可轻松地添加或更新应用程序 而可以实现更好的可伸缩性，降低硬件成本等等。

但是每个虚拟机都需要安装一些多余的东西，比如操作系统，这算是额外的开销。



#### 3.3 容器部署时代

容器类似于 VM，但是它们具有被放宽的隔离属性，可以在应用程序之间共享操作系统（OS）。 因此，容器被认为是轻量级的。容器与 VM 类似，具有自己的文件系统、CPU、内存、进程空间等。可以把容器看做是不用安装操作系统的虚拟机，容器化技术比虚拟机更加灵活，更加小巧，更加极致的利用物理机资源。

容器部署有如下优点：

- 敏捷应用程序的创建和部署：与使用 VM 镜像相比，提高了容器镜像创建的简便性和效率。
- 持续开发、集成和部署：通过快速简单的回滚（由于镜像不可变性），支持可靠且频繁的 容器镜像构建和部署。
- 关注开发与运维的分离：在构建/发布时而不是在部署时创建应用程序容器镜像， 从而将应用程序与基础架构分离。
- 可观察性：不仅可以显示操作系统级别的信息和指标，还可以显示应用程序的运行状况和其他指标信号。
- 跨开发、测试和生产的环境一致性：在便携式计算机上与在云中相同地运行。
- 跨云和操作系统发行版本的可移植性：可在 Ubuntu、RHEL、CoreOS、本地、 Google Kubernetes Engine 和其他任何地方运行。
- 以应用程序为中心的管理：提高抽象级别，从在虚拟硬件上运行 OS 到使用逻辑资源在 OS 上运行应用程序。
- 松散耦合、分布式、弹性、解放的微服务：应用程序被分解成较小的独立部分， 并且可以动态部署和管理 - 而不是在一台大型单机上整体运行。
- 资源隔离：可预测的应用程序性能。
- 资源利用：高效率和高密度。



### 4、为什么需要 Kubernetes?

进入容器化部署时代了，我们会有很多容器需要管理，在生产环境中，我们需要保证容器不会停机，或者容器停机了能够马上自启，能够监控容器运行状态，甚至容器的负载均衡等等，这些 Kubernetes 都可以帮我们做到。

- **服务发现和负载均衡**

  Kubernetes 可以使用 DNS 名称或自己的 IP 地址公开容器，如果进入容器的流量很大， Kubernetes 可以负载均衡并分配网络流量，从而使部署稳定。

- **存储编排**

  Kubernetes 允许你自动挂载你选择的存储系统，例如本地存储、公共云提供商等。

- **自动部署和回滚**

  你可以使用 Kubernetes 描述已部署容器的所需状态，它可以以受控的速率将实际状态 更改为期望状态。例如，你可以自动化 Kubernetes 来为你的部署创建新容器， 删除现有容器并将它们的所有资源用于新容器。

- **自动完成装箱计算**

  Kubernetes 允许你指定每个容器所需 CPU 和内存（RAM）。 当容器指定了资源请求时，Kubernetes 可以做出更好的决策来管理容器的资源。

- **自我修复**

  Kubernetes 重新启动失败的容器、替换容器、杀死不响应用户定义的 运行状况检查的容器，并且在准备好服务之前不将其通告给客户端。

- **密钥与配置管理**

  Kubernetes 允许你存储和管理敏感信息，例如密码、OAuth 令牌和 ssh 密钥。 你可以在不重建容器镜像的情况下部署和更新密钥和应用程序配置，类似热部署，也无需在堆栈配置中暴露密钥。



### 5、Kubernetes 学习网站

①、官网：https://kubernetes.io/

②、中文社区：https://www.kubernetes.org.cn
